AWSTemplateFormatVersion: 2010-09-09
Transform: Mackerel
Description: Mackerel resources

Resources:
  Org:
    Type: Mackerel::Org

  Service:
    Type: Mackerel::Service
    Properties:
      Name: myService

  Role:
    Type: Mackerel::Role
    Properties:
      Service: !Ref Service
      Name: myRole

  Host:
    Type: Mackerel::Host
    Properties:
      Name: myHost
      Roles:
        - !Ref Role

  Downtime:
    Type: Mackerel::Downtime
    Properties:
      Name: test of downtime
      Start: 1573198000
      Duration: 10
      ServiceScopes:
        - !Ref Service
        - !Ref Service
      ServiceExcludeScopes:
        - !Ref Service
        - !Ref Service
      RoleScopes:
        - !Ref Role
        - !Ref Role
      RoleExcludeScopes:
        - !Ref Role
        - !Ref Role
      MonitorScopes:
        - "TODO"
      MonitorExcludeScopes:
        - "TODO"

  DowntimeWithRecurrence:
    Type: Mackerel::Downtime
    Properties:
      Name: test of downtime
      Start: 1573198000
      Duration: 10
      Recurrence:
        Type: weekly
        Interval: 2
        Weekdays:
          - Sunday
          - Saturday
        Until: 1573198000

  User:
    Type: Mackerel::User
    Properties:
      Email: john.doe@example.com

Outputs:
  OrgName:
    Value: !GetAtt Org.Name
  ServiceName:
    Value: !GetAtt Service.Name
  RoleName:
    Value: !GetAtt Role.Name
  RoleFullName:
    Value: !GetAtt Role.FullName
  HostName:
    Value: !GetAtt Host.Name
  UserEmail:
    Value: !GetAtt User.Email
